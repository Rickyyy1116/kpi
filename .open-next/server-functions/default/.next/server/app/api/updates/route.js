(()=>{var e={};e.id=572,e.ids=[572],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73292:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>p,serverHooks:()=>q,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{GET:()=>l,POST:()=>c});var s=r(75224),n=r(91133),d=r(65612),i=r(72529),o=r(14937),u=r(49814);async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("kpiId");if(!r)return i.NextResponse.json({error:"kpiId is required"},{status:400});let a=[{id:"update_1",kpiId:r,value:7,note:"今週の実績",recordedAt:Date.now()-1728e5,createdBy:"user_a"},{id:"update_2",kpiId:r,value:5,note:"先週の実績",recordedAt:Date.now()-7776e5,createdBy:"user_a"}];return i.NextResponse.json({updates:a})}catch(e){return console.error("GET /api/updates error:",e),i.NextResponse.json({error:"Failed to fetch updates"},{status:500})}}async function c(e){try{let t=await (0,u.LE)(),{kpiId:r,value:a,note:s}=await e.json();if(!r||null==a)return i.NextResponse.json({error:"Missing required fields"},{status:400});let n={id:(0,o.Ak)(),kpiId:r,value:Number(a),note:s||null,recordedAt:Date.now(),createdBy:t};return console.log("✅ KPI更新を記録しました（モック）:",n),i.NextResponse.json({update:n},{status:201})}catch(e){return console.error("POST /api/updates error:",e),i.NextResponse.json({error:"Failed to create update"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/updates/route",pathname:"/api/updates",filename:"route",bundlePath:"app/api/updates/route"},resolvedPagePath:"/Users/kawashimariku/Desktop/KPI管理/src/app/api/updates/route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:m,workUnitAsyncStorage:f,serverHooks:q}=p;function y(){return(0,d.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:f})}},84455:()=>{},14719:()=>{},45618:(e,t,r)=>{"use strict";r.r(t),r.d(t,{goals:()=>p,goalsRelations:()=>q,kpiUpdates:()=>f,kpiUpdatesRelations:()=>_,kpis:()=>m,kpisRelations:()=>y,teamMembers:()=>c,teamMembersRelations:()=>N,teams:()=>l,users:()=>u});var a=r(16620),s=r(18762),n=r(42787),d=r(5737),i=r(18884),o=r(75888);let u=(0,a.D)("users",{id:(0,s.Qq)("id").primaryKey(),email:(0,s.Qq)("email").notNull().unique(),name:(0,s.Qq)("name").notNull(),avatarUrl:(0,s.Qq)("avatar_url"),createdAt:(0,n.nd)("created_at",{mode:"timestamp_ms"}).default((0,i.ll)`CURRENT_TIMESTAMP`)}),l=(0,a.D)("teams",{id:(0,s.Qq)("id").primaryKey(),name:(0,s.Qq)("name").notNull(),createdAt:(0,n.nd)("created_at",{mode:"timestamp_ms"}).default((0,i.ll)`CURRENT_TIMESTAMP`)}),c=(0,a.D)("team_members",{id:(0,s.Qq)("id").primaryKey(),teamId:(0,s.Qq)("team_id").notNull().references(()=>l.id),userId:(0,s.Qq)("user_id").notNull().references(()=>u.id),role:(0,s.Qq)("role",{enum:["owner","member"]}).notNull()}),p=(0,a.D)("goals",{id:(0,s.Qq)("id").primaryKey(),teamId:(0,s.Qq)("team_id").notNull().references(()=>l.id),title:(0,s.Qq)("title").notNull(),description:(0,s.Qq)("description"),ownerId:(0,s.Qq)("owner_id").notNull().references(()=>u.id),targetValue:(0,d.x)("target_value").notNull(),unit:(0,s.Qq)("unit").notNull(),dueDate:(0,n.nd)("due_date"),status:(0,s.Qq)("status",{enum:["active","archived"]}).default("active"),createdAt:(0,n.nd)("created_at",{mode:"timestamp_ms"}).default((0,i.ll)`CURRENT_TIMESTAMP`)}),m=(0,a.D)("kpis",{id:(0,s.Qq)("id").primaryKey(),goalId:(0,s.Qq)("goal_id").notNull().references(()=>p.id),title:(0,s.Qq)("title").notNull(),description:(0,s.Qq)("description"),ownerId:(0,s.Qq)("owner_id").notNull().references(()=>u.id),targetValue:(0,d.x)("target_value").notNull(),unit:(0,s.Qq)("unit").notNull(),direction:(0,s.Qq)("direction",{enum:["up","down"]}).notNull(),frequency:(0,s.Qq)("frequency",{enum:["daily","weekly","monthly"]}).notNull(),weight:(0,d.x)("weight").default(1),status:(0,s.Qq)("status",{enum:["active","archived"]}).default("active"),createdAt:(0,n.nd)("created_at",{mode:"timestamp_ms"}).default((0,i.ll)`CURRENT_TIMESTAMP`)}),f=(0,a.D)("kpi_updates",{id:(0,s.Qq)("id").primaryKey(),kpiId:(0,s.Qq)("kpi_id").notNull().references(()=>m.id),value:(0,d.x)("value").notNull(),note:(0,s.Qq)("note"),recordedAt:(0,n.nd)("recorded_at",{mode:"timestamp_ms"}).notNull(),createdBy:(0,s.Qq)("created_by").notNull().references(()=>u.id)}),q=(0,o.K1)(p,({one:e,many:t})=>({team:e(l,{fields:[p.teamId],references:[l.id]}),owner:e(u,{fields:[p.ownerId],references:[u.id]}),kpis:t(m)})),y=(0,o.K1)(m,({one:e,many:t})=>({goal:e(p,{fields:[m.goalId],references:[p.id]}),owner:e(u,{fields:[m.ownerId],references:[u.id]}),updates:t(f)})),_=(0,o.K1)(f,({one:e})=>({kpi:e(m,{fields:[f.kpiId],references:[m.id]}),creator:e(u,{fields:[f.createdBy],references:[u.id]})})),N=(0,o.K1)(c,({one:e})=>({team:e(l,{fields:[c.teamId],references:[l.id]}),user:e(u,{fields:[c.userId],references:[u.id]})}))},49814:(e,t,r)=>{"use strict";r.d(t,{Co:()=>i,LE:()=>d});var a=r(45618),s=r(68919);let n={A:"user_a"};async function d(){return n.A}async function i(e,t){let r=await e.query.teamMembers.findFirst({where:(0,s.eq)(a.teamMembers.userId,t)});return r?r.teamId:"team_default"}},14937:(e,t,r)=>{"use strict";let a,s;r.d(t,{Ak:()=>d});let n=require("node:crypto");function d(e=21){var t;t=e|=0,!a||a.length<t?(a=Buffer.allocUnsafe(128*t),n.webcrypto.getRandomValues(a),s=0):s+t>a.length&&(n.webcrypto.getRandomValues(a),s=0),s+=t;let r="";for(let t=s-e;t<s;t++)r+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&a[t]];return r}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[442,928,87],()=>r(73292));module.exports=a})();